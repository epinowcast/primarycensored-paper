<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<style type="text/css">
@font-face {
font-family: octicons-link;
src: url(data:font/woff;charset=utf-8;base64,d09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM+8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB/aFGpk3jaTY6xa8JAGMW/O62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v+k/0an2i+itHDw3v2+9+DBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3/I7AtxEJLtzzuZfI+VVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy/Lt7Kc+0vWY/gAgIIEqAN9we0pwKXreiMasxvabDQMM4riO+qxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw+ymhce7vwM9jSqO8JyVd5RH9gyTt2+J/yUmYlIR0s04n6+7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv/ocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi+W2+MjCzMIDApSwvXzC97Z4Ig8N/BxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh/8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT+AEjAwuDFpBmA9KMDEwMCh9i/v8H8sH0/4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9/lqYwOGZxeUelN2U2R6+cArgtCJpauW7UQBqnFkUsjAY/kOU1cP+DAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl+vvmM/byA48e6tWrKArm4ZJlCbdsrxksL1AwWn/yBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO//sdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd/89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF+9JOS0nbaaYDCQfwCJ7Au3AHj+LO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm+EBXuAbHmIMSRMs+4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL+hD7C1xoaHeLJSEao0FEW14ckxC+TU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13/+lm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl+9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O/AdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB///AA8AAQAAAAAAAAAAAAAAAAABAAAAAA==) format('woff');
}
body {
-webkit-text-size-adjust: 100%;
text-size-adjust: 100%;
color: #333;
font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
font-size: 16px;
line-height: 1.6;
word-wrap: break-word;
}
a {
background-color: transparent;
}
a:active,
a:hover {
outline: 0;
}
strong {
font-weight: bold;
}
h1 {
font-size: 2em;
margin: 0.67em 0;
}
img {
border: 0;
}
hr {
box-sizing: content-box;
height: 0;
}
pre {
overflow: auto;
}
code,
kbd,
pre {
font-family: monospace, monospace;
font-size: 1em;
}
input {
color: inherit;
font: inherit;
margin: 0;
}
html input[disabled] {
cursor: default;
}
input {
line-height: normal;
}
input[type="checkbox"] {
box-sizing: border-box;
padding: 0;
}
table {
border-collapse: collapse;
border-spacing: 0;
}
td,
th {
padding: 0;
}
* {
box-sizing: border-box;
}
input {
font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}
a {
color: #4078c0;
text-decoration: none;
}
a:hover,
a:active {
text-decoration: underline;
}
hr {
height: 0;
margin: 15px 0;
overflow: hidden;
background: transparent;
border: 0;
border-bottom: 1px solid #ddd;
}
hr:before {
display: table;
content: "";
}
hr:after {
display: table;
clear: both;
content: "";
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 15px;
margin-bottom: 15px;
line-height: 1.1;
}
h1 {
font-size: 30px;
}
h2 {
font-size: 21px;
}
h3 {
font-size: 16px;
}
h4 {
font-size: 14px;
}
h5 {
font-size: 12px;
}
h6 {
font-size: 11px;
}
blockquote {
margin: 0;
}
ul,
ol {
padding: 0;
margin-top: 0;
margin-bottom: 0;
}
ol ol,
ul ol {
list-style-type: lower-roman;
}
ul ul ol,
ul ol ol,
ol ul ol,
ol ol ol {
list-style-type: lower-alpha;
}
dd {
margin-left: 0;
}
code {
font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
font-size: 12px;
}
pre {
margin-top: 0;
margin-bottom: 0;
font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}
.select::-ms-expand {
opacity: 0;
}
.octicon {
font: normal normal normal 16px/1 octicons-link;
display: inline-block;
text-decoration: none;
text-rendering: auto;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.octicon-link:before {
content: '\f05c';
}
.markdown-body:before {
display: table;
content: "";
}
.markdown-body:after {
display: table;
clear: both;
content: "";
}
.markdown-body>*:first-child {
margin-top: 0 !important;
}
.markdown-body>*:last-child {
margin-bottom: 0 !important;
}
a:not([href]) {
color: inherit;
text-decoration: none;
}
.anchor {
display: inline-block;
padding-right: 2px;
margin-left: -18px;
}
.anchor:focus {
outline: none;
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 1em;
margin-bottom: 16px;
font-weight: bold;
line-height: 1.4;
}
h1 .octicon-link,
h2 .octicon-link,
h3 .octicon-link,
h4 .octicon-link,
h5 .octicon-link,
h6 .octicon-link {
color: #000;
vertical-align: middle;
visibility: hidden;
}
h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
text-decoration: none;
}
h1:hover .anchor .octicon-link,
h2:hover .anchor .octicon-link,
h3:hover .anchor .octicon-link,
h4:hover .anchor .octicon-link,
h5:hover .anchor .octicon-link,
h6:hover .anchor .octicon-link {
visibility: visible;
}
h1 {
padding-bottom: 0.3em;
font-size: 2.25em;
line-height: 1.2;
border-bottom: 1px solid #eee;
}
h1 .anchor {
line-height: 1;
}
h2 {
padding-bottom: 0.3em;
font-size: 1.75em;
line-height: 1.225;
border-bottom: 1px solid #eee;
}
h2 .anchor {
line-height: 1;
}
h3 {
font-size: 1.5em;
line-height: 1.43;
}
h3 .anchor {
line-height: 1.2;
}
h4 {
font-size: 1.25em;
}
h4 .anchor {
line-height: 1.2;
}
h5 {
font-size: 1em;
}
h5 .anchor {
line-height: 1.1;
}
h6 {
font-size: 1em;
color: #777;
}
h6 .anchor {
line-height: 1.1;
}
p,
blockquote,
ul,
ol,
dl,
table,
pre {
margin-top: 0;
margin-bottom: 16px;
}
hr {
height: 4px;
padding: 0;
margin: 16px 0;
background-color: #e7e7e7;
border: 0 none;
}
ul,
ol {
padding-left: 2em;
}
ul ul,
ul ol,
ol ol,
ol ul {
margin-top: 0;
margin-bottom: 0;
}
li>p {
margin-top: 16px;
}
dl {
padding: 0;
}
dl dt {
padding: 0;
margin-top: 16px;
font-size: 1em;
font-style: italic;
font-weight: bold;
}
dl dd {
padding: 0 16px;
margin-bottom: 16px;
}
blockquote {
padding: 0 15px;
color: #777;
border-left: 4px solid #ddd;
}
blockquote>:first-child {
margin-top: 0;
}
blockquote>:last-child {
margin-bottom: 0;
}
table {
display: block;
width: 100%;
overflow: auto;
word-break: normal;
word-break: keep-all;
}
table th {
font-weight: bold;
}
table th,
table td {
padding: 6px 13px;
border: 1px solid #ddd;
}
table tr {
background-color: #fff;
border-top: 1px solid #ccc;
}
table tr:nth-child(2n) {
background-color: #f8f8f8;
}
img {
max-width: 100%;
box-sizing: content-box;
background-color: #fff;
}
code {
padding: 0;
padding-top: 0.2em;
padding-bottom: 0.2em;
margin: 0;
font-size: 85%;
background-color: rgba(0,0,0,0.04);
border-radius: 3px;
}
code:before,
code:after {
letter-spacing: -0.2em;
content: "\00a0";
}
pre>code {
padding: 0;
margin: 0;
font-size: 100%;
word-break: normal;
white-space: pre;
background: transparent;
border: 0;
}
.highlight {
margin-bottom: 16px;
}
.highlight pre,
pre {
padding: 16px;
overflow: auto;
font-size: 85%;
line-height: 1.45;
background-color: #f7f7f7;
border-radius: 3px;
}
.highlight pre {
margin-bottom: 0;
word-break: normal;
}
pre {
word-wrap: normal;
}
pre code {
display: inline;
max-width: initial;
padding: 0;
margin: 0;
overflow: initial;
line-height: inherit;
word-wrap: normal;
background-color: transparent;
border: 0;
}
pre code:before,
pre code:after {
content: normal;
}
kbd {
display: inline-block;
padding: 3px 5px;
font-size: 11px;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.pl-c {
color: #969896;
}
.pl-c1,
.pl-s .pl-v {
color: #0086b3;
}
.pl-e,
.pl-en {
color: #795da3;
}
.pl-s .pl-s1,
.pl-smi {
color: #333;
}
.pl-ent {
color: #63a35c;
}
.pl-k {
color: #a71d5d;
}
.pl-pds,
.pl-s,
.pl-s .pl-pse .pl-s1,
.pl-sr,
.pl-sr .pl-cce,
.pl-sr .pl-sra,
.pl-sr .pl-sre {
color: #183691;
}
.pl-v {
color: #ed6a43;
}
.pl-id {
color: #b52a1d;
}
.pl-ii {
background-color: #b52a1d;
color: #f8f8f8;
}
.pl-sr .pl-cce {
color: #63a35c;
font-weight: bold;
}
.pl-ml {
color: #693a17;
}
.pl-mh,
.pl-mh .pl-en,
.pl-ms {
color: #1d3e81;
font-weight: bold;
}
.pl-mq {
color: #008080;
}
.pl-mi {
color: #333;
font-style: italic;
}
.pl-mb {
color: #333;
font-weight: bold;
}
.pl-md {
background-color: #ffecec;
color: #bd2c00;
}
.pl-mi1 {
background-color: #eaffea;
color: #55a532;
}
.pl-mdr {
color: #795da3;
font-weight: bold;
}
.pl-mo {
color: #1d3e81;
}
kbd {
display: inline-block;
padding: 3px 5px;
font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.task-list-item {
list-style-type: none;
}
.task-list-item+.task-list-item {
margin-top: 3px;
}
.task-list-item input {
margin: 0 0.35em 0.25em -1.6em;
vertical-align: middle;
}
:checked+.radio-label {
z-index: 1;
position: relative;
border-color: #4078c0;
}
.sourceLine {
display: inline-block;
}
code .kw { color: #000000; }
code .dt { color: #ed6a43; }
code .dv { color: #009999; }
code .bn { color: #009999; }
code .fl { color: #009999; }
code .ch { color: #009999; }
code .st { color: #183691; }
code .co { color: #969896; }
code .ot { color: #0086b3; }
code .al { color: #a61717; }
code .fu { color: #63a35c; }
code .er { color: #a61717; background-color: #e3d2d2; }
code .wa { color: #000000; }
code .cn { color: #008080; }
code .sc { color: #008080; }
code .vs { color: #183691; }
code .ss { color: #183691; }
code .im { color: #000000; }
code .va {color: #008080; }
code .cf { color: #000000; }
code .op { color: #000000; }
code .bu { color: #000000; }
code .ex { color: #000000; }
code .pp { color: #999999; }
code .at { color: #008080; }
code .do { color: #969896; }
code .an { color: #008080; }
code .cv { color: #008080; }
code .in { color: #008080; }
</style>
<style>
body {
box-sizing: border-box;
min-width: 200px;
max-width: 980px;
margin: 0 auto;
padding: 45px;
padding-top: 0px;
}
</style>


</head>

<body>

<h1 id="analysis-pipeline-primary-event-censored-distributions">Analysis
Pipeline: Primary Event Censored Distributions</h1>
<h1 id="introduction">Introduction</h1>
<p>This reproducible pipeline implements the complete analysis for
“Modelling delays with primary Event Censored Distributions” by Brand et
al. The analysis validates our novel statistical method for handling
double interval censored data in epidemiological delay distribution
estimation.</p>
<p>The pipeline is structured to mirror the manuscript sections:</p>
<ol style="list-style-type: decimal">
<li><strong>Numerical validation</strong> - Comparing our analytical and
numerical solutions against Monte Carlo simulations</li>
<li><strong>Parameter recovery</strong> - Evaluating bias and accuracy
across different censoring and truncation scenarios</li>
<li><strong>Case study</strong> - Applying methods to real Ebola
epidemic data from Sierra Leone</li>
</ol>
<h1 id="setup">Setup</h1>
<p>Load required packages and initialize the targets workflow.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(targets)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(tarchetypes)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">tar_unscript</span>()</span></code></pre></div>
<p>Define global options and load custom functions.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(targets)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(tarchetypes)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="fu">library</span>(crew)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co"># Source all R functions</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>functions <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="fu">here</span>(<span class="st">&quot;R&quot;</span>), <span class="at">full.names =</span> <span class="cn">TRUE</span>, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.R$&quot;</span>)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="fu">walk</span>(functions, source)</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="fu">rm</span>(<span class="st">&quot;functions&quot;</span>)</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co"># Set up crew controller for parallel processing</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>controller <span class="ot">&lt;-</span> <span class="fu">crew_controller_local</span>(</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">&quot;primarycensored_crew&quot;</span>,</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>  <span class="at">workers =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>,  <span class="co"># Leave one core free</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>  <span class="at">seconds_idle =</span> <span class="dv">30</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>)</span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co"># Set targets options</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="fu">tar_option_set</span>(</span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>  <span class="at">packages =</span> <span class="fu">c</span>(<span class="st">&quot;data.table&quot;</span>, <span class="st">&quot;ggplot2&quot;</span>, <span class="st">&quot;patchwork&quot;</span>, <span class="st">&quot;purrr&quot;</span>, <span class="st">&quot;here&quot;</span>, <span class="st">&quot;dplyr&quot;</span>, </span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>               <span class="st">&quot;tidyr&quot;</span>, <span class="st">&quot;qs2&quot;</span>, <span class="st">&quot;primarycensored&quot;</span>, <span class="st">&quot;cmdstanr&quot;</span>),</span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>  <span class="at">format =</span> <span class="st">&quot;qs&quot;</span>,  <span class="co"># Use qs format (qs2 is used via repository option)</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>  <span class="at">memory =</span> <span class="st">&quot;transient&quot;</span>,  <span class="co"># Free memory after each target completes</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>  <span class="at">garbage_collection =</span> <span class="cn">TRUE</span>,  <span class="co"># Run garbage collection</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a>  <span class="at">controller =</span> controller,  <span class="co"># Use crew for parallel processing</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a>  <span class="at">repository =</span> <span class="st">&quot;local&quot;</span>  <span class="co"># Use qs2 backend for storage</span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a>)</span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/globals/globals.R.</span></span></code></pre></div>
<h1 id="data-preparation">Data Preparation</h1>
<h2 id="define-distributions">Define distributions</h2>
<p>We test two distributions with a common mean of 5 days but varying
variance:</p>
<ul>
<li><strong>Gamma</strong> (shape k=5, scale θ=1): Moderate variance
scenario with analytical solution</li>
<li><strong>Lognormal</strong> (location μ=1.5, scale σ=0.5): Higher
variance with analytical solution</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  distributions,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>    <span class="at">dist_name =</span> <span class="fu">c</span>(<span class="st">&quot;gamma&quot;</span>, <span class="st">&quot;lognormal&quot;</span>, <span class="st">&quot;burr&quot;</span>),</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>    <span class="at">dist_family =</span> <span class="fu">c</span>(<span class="st">&quot;gamma&quot;</span>, <span class="st">&quot;lnorm&quot;</span>, <span class="st">&quot;burr&quot;</span>),</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>    <span class="at">param1 =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="fl">1.5</span>, <span class="dv">3</span>),       <span class="co"># shape/meanlog/shape1</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>    <span class="at">param2 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span>),     <span class="co"># scale/sdlog/shape2</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>    <span class="at">param3 =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="dv">4</span>),       <span class="co"># NA/NA/scale</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>),           <span class="co"># All have mean = 5 days</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>    <span class="at">variance =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">10</span>),     <span class="co"># Increasing variance</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>    <span class="at">has_analytical =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>  )</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>)</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/distributions.R.</span></span></code></pre></div>
<h2 id="define-truncation-scenarios">Define truncation scenarios</h2>
<p>We test three truncation scenarios representing different stages of
outbreak analysis:</p>
<ul>
<li><strong>No truncation</strong>: Retrospective scenario with all
events observable</li>
<li><strong>Moderate truncation</strong>: Real-time scenario with 10-day
observation window</li>
<li><strong>Severe truncation</strong>: Challenging real-time scenario
with 5-day window</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  truncation_scenarios,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>    <span class="at">trunc_name =</span> <span class="fu">c</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;moderate&quot;</span>, <span class="st">&quot;severe&quot;</span>),</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>    <span class="at">max_delay =</span> <span class="fu">c</span>(<span class="cn">Inf</span>, <span class="dv">10</span>, <span class="dv">5</span>),</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>    <span class="at">scenario_type =</span> <span class="fu">c</span>(<span class="st">&quot;retrospective&quot;</span>, <span class="st">&quot;real-time&quot;</span>, <span class="st">&quot;real-time&quot;</span>)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  )</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/truncation_scenarios.R.</span></span></code></pre></div>
<h2 id="define-censoring-patterns">Define censoring patterns</h2>
<p>Both primary and secondary events have censoring windows ranging from
1-4 days.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  censoring_scenarios,</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>    <span class="at">cens_name =</span> <span class="fu">c</span>(<span class="st">&quot;daily&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;weekly&quot;</span>),</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    <span class="at">primary_width =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>),</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>    <span class="at">secondary_width =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  )</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/censoring_scenarios.R.</span></span></code></pre></div>
<h2 id="create-full-scenario-grid">Create full scenario grid</h2>
<p>Combine all scenarios into a full factorial design (9 scenarios total
as per manuscript).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  scenario_grid,</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  {</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>    <span class="co"># Create all combinations</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>    grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>      <span class="at">distribution =</span> distributions<span class="sc">$</span>dist_name,</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>      <span class="at">truncation =</span> truncation_scenarios<span class="sc">$</span>trunc_name,</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>      <span class="at">censoring =</span> censoring_scenarios<span class="sc">$</span>cens_name,</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>    )</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>    </span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>    <span class="co"># Add details from component data frames</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>    grid<span class="sc">$</span>scenario_id <span class="ot">&lt;-</span> <span class="fu">paste</span>(grid<span class="sc">$</span>distribution, grid<span class="sc">$</span>truncation, grid<span class="sc">$</span>censoring, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>    grid<span class="sc">$</span>n <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 10,000 observations per scenario</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>    grid<span class="sc">$</span>seed <span class="ot">&lt;-</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(grid)) <span class="sc">+</span> <span class="dv">100</span>  <span class="co"># Unique seed per scenario</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>    </span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>    grid</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>  }</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>)</span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/scenario_grid.R.</span></span></code></pre></div>
<h2 id="load-ebola-case-study-data">Load Ebola case study data</h2>
<p>Load the Sierra Leone Ebola data (2014-2016) for the case study
analysis (Methods lines 288-292).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  ebola_data,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  {</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>    <span class="co"># Placeholder for Ebola linelist data</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>    <span class="co"># Real implementation would load Fang et al. 2016 data</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">&quot;Loading Ebola case study data...&quot;</span>)</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>    </span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>    <span class="co"># Simulate example structure</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>      <span class="at">case_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>,</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>      <span class="at">symptom_onset_date =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2014-05-01&quot;</span>) <span class="sc">+</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">500</span>, <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>      <span class="at">sample_date =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2014-05-01&quot;</span>) <span class="sc">+</span> <span class="fu">sample</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">510</span>, <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(sample_date <span class="sc">&gt;</span> symptom_onset_date)</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>  }</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>)</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/ebola_data.R.</span></span></code></pre></div>
<h2 id="define-observation-windows-for-case-study">Define observation
windows for case study</h2>
<p>Four 60-day windows as specified in the manuscript.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  observation_windows,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>    <span class="at">window_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>    <span class="at">start_day =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="dv">120</span>, <span class="dv">180</span>),</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>    <span class="at">end_day =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">120</span>, <span class="dv">180</span>, <span class="dv">240</span>),</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>    <span class="at">window_label =</span> <span class="fu">c</span>(<span class="st">&quot;0-60 days&quot;</span>, <span class="st">&quot;60-120 days&quot;</span>, <span class="st">&quot;120-180 days&quot;</span>, <span class="st">&quot;180-240 days&quot;</span>)</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  )</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>)</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/observation_windows.R.</span></span></code></pre></div>
<h1 id="numerical-validation">Numerical Validation</h1>
<h2 id="generate-simulated-datasets">Generate simulated datasets</h2>
<p>We simulate data for each scenario combination using the
primarycensored package.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Create a list for dynamic branching over all scenario combinations</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  scenario_list,</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  {</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>    <span class="co"># Join all scenario details</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>    scenarios <span class="ot">&lt;-</span> scenario_grid <span class="sc">|&gt;</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">left_join</span>(distributions, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;distribution&quot;</span> <span class="ot">=</span> <span class="st">&quot;dist_name&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">left_join</span>(truncation_scenarios, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;truncation&quot;</span> <span class="ot">=</span> <span class="st">&quot;trunc_name&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">left_join</span>(censoring_scenarios, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;censoring&quot;</span> <span class="ot">=</span> <span class="st">&quot;cens_name&quot;</span>))</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>    </span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>    <span class="co"># Split for branching</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>    <span class="fu">split</span>(scenarios, scenarios<span class="sc">$</span>scenario_id)</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>  }</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>)</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/scenario_list.R.</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  simulated_data,</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  {</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>    <span class="fu">library</span>(primarycensored)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>    params <span class="ot">&lt;-</span> scenario_list[[<span class="dv">1</span>]]</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>    <span class="fu">set.seed</span>(params<span class="sc">$</span>seed)</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>    </span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>    <span class="co"># Generate primary event times with exponential growth</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>    n_obs <span class="ot">&lt;-</span> params<span class="sc">$</span>n</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>    growth_rate <span class="ot">&lt;-</span> <span class="fl">0.2</span>  <span class="co"># As per manuscript</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>    prim_times <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(<span class="fu">rexp</span>(n_obs, <span class="at">rate =</span> growth_rate))</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>    </span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>    <span class="co"># Generate delays using rprimarycensored</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>    delays <span class="ot">&lt;-</span> <span class="fu">rprimarycensored</span>(</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>      <span class="at">n =</span> n_obs,</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>      <span class="at">rdist =</span> <span class="fu">get</span>(<span class="fu">paste0</span>(<span class="st">&quot;r&quot;</span>, params<span class="sc">$</span>dist_family)),</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>      <span class="at">rprimary =</span> runif,  <span class="co"># Uniform primary distribution</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>      <span class="at">pwindow =</span> params<span class="sc">$</span>primary_width,</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>      <span class="at">swindow =</span> params<span class="sc">$</span>secondary_width,</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>      <span class="at">D =</span> params<span class="sc">$</span>max_delay</span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>    )</span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a>    </span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a>    <span class="co"># Create censored observations</span></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a>      <span class="at">obs_id =</span> <span class="fu">seq_len</span>(n_obs),</span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a>      <span class="at">scenario_id =</span> params<span class="sc">$</span>scenario_id,</span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a>      <span class="at">prim_cens_lower =</span> <span class="fu">floor</span>(prim_times),</span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a>      <span class="at">prim_cens_upper =</span> <span class="fu">floor</span>(prim_times) <span class="sc">+</span> params<span class="sc">$</span>primary_width,</span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a>      <span class="at">delay_observed =</span> delays,</span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a>      <span class="at">sec_cens_lower =</span> <span class="fu">floor</span>(prim_times <span class="sc">+</span> delays),</span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a>      <span class="at">sec_cens_upper =</span> <span class="fu">floor</span>(prim_times <span class="sc">+</span> delays) <span class="sc">+</span> params<span class="sc">$</span>secondary_width,</span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a>      <span class="at">distribution =</span> params<span class="sc">$</span>distribution,</span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a>      <span class="at">truncation =</span> params<span class="sc">$</span>truncation,</span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a>      <span class="at">censoring =</span> params<span class="sc">$</span>censoring,</span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a>      <span class="at">true_params =</span> <span class="fu">list</span>(<span class="at">param1 =</span> params<span class="sc">$</span>param1, <span class="at">param2 =</span> params<span class="sc">$</span>param2)</span>
<span id="cb10-36"><a href="#cb10-36" tabindex="-1"></a>    )</span>
<span id="cb10-37"><a href="#cb10-37" tabindex="-1"></a>  },</span>
<span id="cb10-38"><a href="#cb10-38" tabindex="-1"></a>  <span class="at">pattern =</span> <span class="fu">map</span>(scenario_list)</span>
<span id="cb10-39"><a href="#cb10-39" tabindex="-1"></a>)</span>
<span id="cb10-40"><a href="#cb10-40" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/simulated_data.R.</span></span></code></pre></div>
<h2 id="generate-monte-carlo-reference-samples">Generate Monte Carlo
reference samples</h2>
<p>We need Monte Carlo samples at different sizes for numerical
validation.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  monte_carlo_samples,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  {</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>    <span class="fu">library</span>(primarycensored)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>    sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>, <span class="dv">10000</span>)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>    </span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>    <span class="co"># Generate Monte Carlo samples for each distribution and sample size</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">map_dfr</span>(distributions<span class="sc">$</span>dist_name, <span class="cf">function</span>(dist_name) {</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>      dist_info <span class="ot">&lt;-</span> distributions[distributions<span class="sc">$</span>dist_name <span class="sc">==</span> dist_name, ]</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>      </span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>      purrr<span class="sc">::</span><span class="fu">map_dfr</span>(sample_sizes, <span class="cf">function</span>(n) {</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>        <span class="co"># Generate large Monte Carlo sample</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>        mc_samples <span class="ot">&lt;-</span> <span class="fu">rprimarycensored</span>(</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>          <span class="at">n =</span> n,</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>          <span class="at">rdist =</span> <span class="fu">get</span>(<span class="fu">paste0</span>(<span class="st">&quot;r&quot;</span>, dist_info<span class="sc">$</span>dist_family)),</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>          <span class="at">rprimary =</span> runif,</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>          <span class="at">pwindow =</span> <span class="dv">1</span>,</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>          <span class="at">swindow =</span> <span class="dv">1</span>,</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>          <span class="at">D =</span> <span class="cn">Inf</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>        )</span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>        </span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>        <span class="co"># Calculate empirical PMF</span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>        pmf <span class="ot">&lt;-</span> <span class="fu">table</span>(mc_samples) <span class="sc">/</span> n</span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a>        </span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>        <span class="fu">data.frame</span>(</span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a>          <span class="at">distribution =</span> dist_name,</span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a>          <span class="at">sample_size =</span> n,</span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a>          <span class="at">delay =</span> <span class="fu">as.numeric</span>(<span class="fu">names</span>(pmf)),</span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a>          <span class="at">probability =</span> <span class="fu">as.numeric</span>(pmf)</span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a>        )</span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a>      })</span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a>    })</span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a>  }</span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a>)</span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/monte_carlo_samples.R.</span></span></code></pre></div>
<h2 id="compare-pmf-calculations">Compare PMF calculations</h2>
<p>We validate our analytical and numerical solutions against Monte
Carlo.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  pmf_comparison,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  {</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>    <span class="fu">library</span>(primarycensored)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>    </span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>    <span class="co"># Compare analytical, numerical, and Monte Carlo PMFs</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">map_dfr</span>(distributions<span class="sc">$</span>dist_name, <span class="cf">function</span>(dist_name) {</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>      dist_info <span class="ot">&lt;-</span> distributions[distributions<span class="sc">$</span>dist_name <span class="sc">==</span> dist_name, ]</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>      </span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>      <span class="co"># Define delay values to evaluate</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>      delays <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>      </span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>      <span class="co"># Analytical PMF (for gamma and lognormal)</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>      <span class="cf">if</span> (dist_info<span class="sc">$</span>has_analytical) {</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>        analytical_pmf <span class="ot">&lt;-</span> <span class="fu">dprimarycensored</span>(</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>          <span class="at">x =</span> delays,</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>          <span class="at">pdist =</span> <span class="fu">get</span>(<span class="fu">paste0</span>(<span class="st">&quot;p&quot;</span>, dist_info<span class="sc">$</span>dist_family)),</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>          <span class="at">pwindow =</span> <span class="dv">1</span>,</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>          <span class="at">swindow =</span> <span class="dv">1</span>,</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>          <span class="at">D =</span> <span class="cn">Inf</span>,</span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>          <span class="at">dprimary =</span> dunif,</span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>          <span class="at">dist_params =</span> <span class="fu">list</span>(</span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>            <span class="at">shape =</span> dist_info<span class="sc">$</span>param1,</span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>            <span class="at">scale =</span> dist_info<span class="sc">$</span>param2</span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a>          )</span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a>        )</span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a>        analytical_pmf <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(delays))</span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a>      }</span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a>      </span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a>      <span class="co"># Numerical PMF (all distributions)</span></span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a>      numerical_pmf <span class="ot">&lt;-</span> <span class="fu">dprimarycensored</span>(</span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a>        <span class="at">x =</span> delays,</span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a>        <span class="at">pdist =</span> <span class="fu">get</span>(<span class="fu">paste0</span>(<span class="st">&quot;p&quot;</span>, dist_info<span class="sc">$</span>dist_family)),</span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a>        <span class="at">pwindow =</span> <span class="dv">1</span>,</span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a>        <span class="at">swindow =</span> <span class="dv">1</span>,</span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a>        <span class="at">D =</span> <span class="cn">Inf</span>,</span>
<span id="cb12-38"><a href="#cb12-38" tabindex="-1"></a>        <span class="at">dprimary =</span> dunif,</span>
<span id="cb12-39"><a href="#cb12-39" tabindex="-1"></a>        <span class="at">dist_params =</span> <span class="cf">if</span>(dist_name <span class="sc">==</span> <span class="st">&quot;burr&quot;</span>) {</span>
<span id="cb12-40"><a href="#cb12-40" tabindex="-1"></a>          <span class="fu">list</span>(<span class="at">shape1 =</span> dist_info<span class="sc">$</span>param1, <span class="at">shape2 =</span> dist_info<span class="sc">$</span>param2, <span class="at">scale =</span> dist_info<span class="sc">$</span>param3)</span>
<span id="cb12-41"><a href="#cb12-41" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb12-42"><a href="#cb12-42" tabindex="-1"></a>          <span class="fu">list</span>(<span class="at">shape =</span> dist_info<span class="sc">$</span>param1, <span class="at">scale =</span> dist_info<span class="sc">$</span>param2)</span>
<span id="cb12-43"><a href="#cb12-43" tabindex="-1"></a>        },</span>
<span id="cb12-44"><a href="#cb12-44" tabindex="-1"></a>        <span class="at">use_numerical =</span> <span class="cn">TRUE</span></span>
<span id="cb12-45"><a href="#cb12-45" tabindex="-1"></a>      )</span>
<span id="cb12-46"><a href="#cb12-46" tabindex="-1"></a>      </span>
<span id="cb12-47"><a href="#cb12-47" tabindex="-1"></a>      <span class="co"># Get Monte Carlo PMF</span></span>
<span id="cb12-48"><a href="#cb12-48" tabindex="-1"></a>      mc_pmf <span class="ot">&lt;-</span> monte_carlo_samples <span class="sc">%&gt;%</span></span>
<span id="cb12-49"><a href="#cb12-49" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">filter</span>(distribution <span class="sc">==</span> dist_name, sample_size <span class="sc">==</span> <span class="dv">10000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-50"><a href="#cb12-50" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">filter</span>(delay <span class="sc">%in%</span> delays) <span class="sc">%&gt;%</span></span>
<span id="cb12-51"><a href="#cb12-51" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">pull</span>(probability)</span>
<span id="cb12-52"><a href="#cb12-52" tabindex="-1"></a>      </span>
<span id="cb12-53"><a href="#cb12-53" tabindex="-1"></a>      <span class="co"># Calculate total variation distance</span></span>
<span id="cb12-54"><a href="#cb12-54" tabindex="-1"></a>      tvd_analytical <span class="ot">&lt;-</span> <span class="cf">if</span>(<span class="fu">any</span>(<span class="sc">!</span><span class="fu">is.na</span>(analytical_pmf))) {</span>
<span id="cb12-55"><a href="#cb12-55" tabindex="-1"></a>        <span class="fu">sum</span>(<span class="fu">abs</span>(analytical_pmf <span class="sc">-</span> mc_pmf)) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb12-56"><a href="#cb12-56" tabindex="-1"></a>      } <span class="cf">else</span> { <span class="cn">NA</span> }</span>
<span id="cb12-57"><a href="#cb12-57" tabindex="-1"></a>      </span>
<span id="cb12-58"><a href="#cb12-58" tabindex="-1"></a>      tvd_numerical <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">abs</span>(numerical_pmf <span class="sc">-</span> mc_pmf)) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb12-59"><a href="#cb12-59" tabindex="-1"></a>      </span>
<span id="cb12-60"><a href="#cb12-60" tabindex="-1"></a>      <span class="fu">data.frame</span>(</span>
<span id="cb12-61"><a href="#cb12-61" tabindex="-1"></a>        <span class="at">distribution =</span> dist_name,</span>
<span id="cb12-62"><a href="#cb12-62" tabindex="-1"></a>        <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;analytical&quot;</span>, <span class="st">&quot;numerical&quot;</span>),</span>
<span id="cb12-63"><a href="#cb12-63" tabindex="-1"></a>        <span class="at">total_variation_distance =</span> <span class="fu">c</span>(tvd_analytical, tvd_numerical)</span>
<span id="cb12-64"><a href="#cb12-64" tabindex="-1"></a>      )</span>
<span id="cb12-65"><a href="#cb12-65" tabindex="-1"></a>    })</span>
<span id="cb12-66"><a href="#cb12-66" tabindex="-1"></a>  }</span>
<span id="cb12-67"><a href="#cb12-67" tabindex="-1"></a>)</span>
<span id="cb12-68"><a href="#cb12-68" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/pmf_comparison.R.</span></span></code></pre></div>
<h2 id="runtime-comparison">Runtime comparison</h2>
<p>Measure computational efficiency across methods.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  runtime_comparison,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  {</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>    <span class="fu">library</span>(primarycensored)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>    sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>, <span class="dv">10000</span>)</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>    </span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>    <span class="co"># Measure runtime for different methods</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">map_dfr</span>(sample_sizes, <span class="cf">function</span>(n) {</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>      <span class="co"># Analytical (gamma)</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>      time_analytical <span class="ot">&lt;-</span> <span class="fu">system.time</span>({</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>        <span class="fu">dprimarycensored</span>(</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>          <span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>          <span class="at">pdist =</span> pgamma,</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>          <span class="at">pwindow =</span> <span class="dv">1</span>,</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>          <span class="at">swindow =</span> <span class="dv">1</span>,</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>          <span class="at">D =</span> <span class="cn">Inf</span>,</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>          <span class="at">dprimary =</span> dunif,</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a>          <span class="at">dist_params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">5</span>, <span class="at">scale =</span> <span class="dv">1</span>)</span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a>        )</span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>      })[<span class="st">&quot;elapsed&quot;</span>]</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a>      </span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a>      <span class="co"># Numerical (burr)</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a>      time_numerical <span class="ot">&lt;-</span> <span class="fu">system.time</span>({</span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a>        <span class="fu">dprimarycensored</span>(</span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a>          <span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a>          <span class="at">pdist =</span> <span class="cf">function</span>(q, ...) <span class="fu">pburr</span>(q, ...),</span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a>          <span class="at">pwindow =</span> <span class="dv">1</span>,</span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a>          <span class="at">swindow =</span> <span class="dv">1</span>,</span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a>          <span class="at">D =</span> <span class="cn">Inf</span>,</span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a>          <span class="at">dprimary =</span> dunif,</span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a>          <span class="at">dist_params =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="dv">3</span>, <span class="at">shape2 =</span> <span class="fl">1.5</span>, <span class="at">scale =</span> <span class="dv">4</span>),</span>
<span id="cb13-32"><a href="#cb13-32" tabindex="-1"></a>          <span class="at">use_numerical =</span> <span class="cn">TRUE</span></span>
<span id="cb13-33"><a href="#cb13-33" tabindex="-1"></a>        )</span>
<span id="cb13-34"><a href="#cb13-34" tabindex="-1"></a>      })[<span class="st">&quot;elapsed&quot;</span>]</span>
<span id="cb13-35"><a href="#cb13-35" tabindex="-1"></a>      </span>
<span id="cb13-36"><a href="#cb13-36" tabindex="-1"></a>      <span class="co"># Monte Carlo baseline</span></span>
<span id="cb13-37"><a href="#cb13-37" tabindex="-1"></a>      time_mc <span class="ot">&lt;-</span> <span class="fu">system.time</span>({</span>
<span id="cb13-38"><a href="#cb13-38" tabindex="-1"></a>        <span class="fu">rprimarycensored</span>(</span>
<span id="cb13-39"><a href="#cb13-39" tabindex="-1"></a>          <span class="at">n =</span> n,</span>
<span id="cb13-40"><a href="#cb13-40" tabindex="-1"></a>          <span class="at">rdist =</span> rgamma,</span>
<span id="cb13-41"><a href="#cb13-41" tabindex="-1"></a>          <span class="at">rprimary =</span> runif,</span>
<span id="cb13-42"><a href="#cb13-42" tabindex="-1"></a>          <span class="at">pwindow =</span> <span class="dv">1</span>,</span>
<span id="cb13-43"><a href="#cb13-43" tabindex="-1"></a>          <span class="at">swindow =</span> <span class="dv">1</span>,</span>
<span id="cb13-44"><a href="#cb13-44" tabindex="-1"></a>          <span class="at">D =</span> <span class="cn">Inf</span>,</span>
<span id="cb13-45"><a href="#cb13-45" tabindex="-1"></a>          <span class="at">shape =</span> <span class="dv">5</span>, <span class="at">scale =</span> <span class="dv">1</span></span>
<span id="cb13-46"><a href="#cb13-46" tabindex="-1"></a>        )</span>
<span id="cb13-47"><a href="#cb13-47" tabindex="-1"></a>      })[<span class="st">&quot;elapsed&quot;</span>]</span>
<span id="cb13-48"><a href="#cb13-48" tabindex="-1"></a>      </span>
<span id="cb13-49"><a href="#cb13-49" tabindex="-1"></a>      <span class="fu">data.frame</span>(</span>
<span id="cb13-50"><a href="#cb13-50" tabindex="-1"></a>        <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;analytical&quot;</span>, <span class="st">&quot;numerical&quot;</span>, <span class="st">&quot;monte_carlo&quot;</span>),</span>
<span id="cb13-51"><a href="#cb13-51" tabindex="-1"></a>        <span class="at">sample_size =</span> n,</span>
<span id="cb13-52"><a href="#cb13-52" tabindex="-1"></a>        <span class="at">runtime_seconds =</span> <span class="fu">c</span>(time_analytical, time_numerical, time_mc)</span>
<span id="cb13-53"><a href="#cb13-53" tabindex="-1"></a>      )</span>
<span id="cb13-54"><a href="#cb13-54" tabindex="-1"></a>    })</span>
<span id="cb13-55"><a href="#cb13-55" tabindex="-1"></a>  }</span>
<span id="cb13-56"><a href="#cb13-56" tabindex="-1"></a>)</span>
<span id="cb13-57"><a href="#cb13-57" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/runtime_comparison.R.</span></span></code></pre></div>
<h1 id="parameter-recovery">Parameter Recovery</h1>
<h2 id="fit-primary-censored-models">Fit primary censored models</h2>
<p>Our method that accounts for double interval censoring through
analytical marginalisation.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  primarycensored_fits,</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  {</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>    <span class="fu">library</span>(primarycensored)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>    </span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>    <span class="co"># Fit using fitdistr for maximum likelihood</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>    fit_result <span class="ot">&lt;-</span> <span class="fu">fitdistcens</span>(</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>      <span class="at">censdata =</span> simulated_data,</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>      <span class="at">distr =</span> simulated_data<span class="sc">$</span>distribution[<span class="dv">1</span>],</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>      <span class="at">start =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">4</span>, <span class="at">scale =</span> <span class="dv">1</span>)  <span class="co"># Initial values</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>    )</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>    </span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>    <span class="co"># Extract estimates</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>      <span class="at">scenario_id =</span> simulated_data<span class="sc">$</span>scenario_id[<span class="dv">1</span>],</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">&quot;primarycensored&quot;</span>,</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>      <span class="at">param1_est =</span> fit_result<span class="sc">$</span>estimate[<span class="dv">1</span>],</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>      <span class="at">param1_se =</span> fit_result<span class="sc">$</span>sd[<span class="dv">1</span>],</span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>      <span class="at">param2_est =</span> fit_result<span class="sc">$</span>estimate[<span class="dv">2</span>],</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>      <span class="at">param2_se =</span> fit_result<span class="sc">$</span>sd[<span class="dv">2</span>],</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>      <span class="at">convergence =</span> fit_result<span class="sc">$</span>convergence,</span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a>      <span class="at">loglik =</span> fit_result<span class="sc">$</span>loglik</span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a>    )</span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a>  },</span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a>  <span class="at">pattern =</span> <span class="fu">map</span>(simulated_data)</span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a>)</span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/fit_primarycensored.R.</span></span></code></pre></div>
<h2 id="fit-naive-models">Fit naive models</h2>
<p>Baseline comparison that ignores primary event censoring.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  naive_fits,</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  {</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>    <span class="fu">library</span>(cmdstanr)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>    </span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>    <span class="co"># Map distribution names to IDs</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>    dist_map <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;gamma&quot;</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">&quot;lognormal&quot;</span> <span class="ot">=</span> <span class="dv">2</span>)</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>    dist_id <span class="ot">&lt;-</span> dist_map[simulated_data<span class="sc">$</span>distribution[<span class="dv">1</span>]]</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>    </span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>    <span class="co"># Skip Burr distribution (no analytical form in naive model)</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.na</span>(dist_id)) {</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">data.frame</span>(</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>        <span class="at">scenario_id =</span> simulated_data<span class="sc">$</span>scenario_id[<span class="dv">1</span>],</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">&quot;naive&quot;</span>,</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>        <span class="at">param1_est =</span> <span class="cn">NA</span>,</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>        <span class="at">param1_se =</span> <span class="cn">NA</span>,</span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>        <span class="at">param2_est =</span> <span class="cn">NA</span>,</span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>        <span class="at">param2_se =</span> <span class="cn">NA</span>,</span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a>        <span class="at">convergence =</span> <span class="dv">1</span>,</span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a>        <span class="at">loglik =</span> <span class="cn">NA</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a>      ))</span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a>    }</span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a>    </span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a>    <span class="co"># Prepare data for Stan</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a>    stan_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a>      <span class="at">N =</span> <span class="fu">nrow</span>(simulated_data),</span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a>      <span class="at">delay_lower =</span> simulated_data<span class="sc">$</span>sec_cens_lower <span class="sc">-</span> simulated_data<span class="sc">$</span>prim_cens_lower,</span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a>      <span class="at">delay_upper =</span> simulated_data<span class="sc">$</span>sec_cens_upper <span class="sc">-</span> simulated_data<span class="sc">$</span>prim_cens_upper,</span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a>      <span class="at">dist_id =</span> dist_id</span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a>    )</span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a>    </span>
<span id="cb15-32"><a href="#cb15-32" tabindex="-1"></a>    <span class="co"># Compile and fit model</span></span>
<span id="cb15-33"><a href="#cb15-33" tabindex="-1"></a>    mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="fu">here</span>(<span class="st">&quot;stan/naive_delay_model.stan&quot;</span>))</span>
<span id="cb15-34"><a href="#cb15-34" tabindex="-1"></a>    </span>
<span id="cb15-35"><a href="#cb15-35" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb15-36"><a href="#cb15-36" tabindex="-1"></a>      <span class="at">data =</span> stan_data,</span>
<span id="cb15-37"><a href="#cb15-37" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb15-38"><a href="#cb15-38" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb15-39"><a href="#cb15-39" tabindex="-1"></a>      <span class="at">parallel_chains =</span> <span class="dv">2</span>,</span>
<span id="cb15-40"><a href="#cb15-40" tabindex="-1"></a>      <span class="at">iter_warmup =</span> <span class="dv">500</span>,</span>
<span id="cb15-41"><a href="#cb15-41" tabindex="-1"></a>      <span class="at">iter_sampling =</span> <span class="dv">1000</span>,</span>
<span id="cb15-42"><a href="#cb15-42" tabindex="-1"></a>      <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb15-43"><a href="#cb15-43" tabindex="-1"></a>    )</span>
<span id="cb15-44"><a href="#cb15-44" tabindex="-1"></a>    </span>
<span id="cb15-45"><a href="#cb15-45" tabindex="-1"></a>    <span class="co"># Extract estimates</span></span>
<span id="cb15-46"><a href="#cb15-46" tabindex="-1"></a>    draws <span class="ot">&lt;-</span> fit<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">&quot;param1&quot;</span>, <span class="st">&quot;param2&quot;</span>), <span class="at">format =</span> <span class="st">&quot;df&quot;</span>)</span>
<span id="cb15-47"><a href="#cb15-47" tabindex="-1"></a>    </span>
<span id="cb15-48"><a href="#cb15-48" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb15-49"><a href="#cb15-49" tabindex="-1"></a>      <span class="at">scenario_id =</span> simulated_data<span class="sc">$</span>scenario_id[<span class="dv">1</span>],</span>
<span id="cb15-50"><a href="#cb15-50" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">&quot;naive&quot;</span>,</span>
<span id="cb15-51"><a href="#cb15-51" tabindex="-1"></a>      <span class="at">param1_est =</span> <span class="fu">mean</span>(draws<span class="sc">$</span>param1),</span>
<span id="cb15-52"><a href="#cb15-52" tabindex="-1"></a>      <span class="at">param1_se =</span> <span class="fu">sd</span>(draws<span class="sc">$</span>param1),</span>
<span id="cb15-53"><a href="#cb15-53" tabindex="-1"></a>      <span class="at">param2_est =</span> <span class="fu">mean</span>(draws<span class="sc">$</span>param2),</span>
<span id="cb15-54"><a href="#cb15-54" tabindex="-1"></a>      <span class="at">param2_se =</span> <span class="fu">sd</span>(draws<span class="sc">$</span>param2),</span>
<span id="cb15-55"><a href="#cb15-55" tabindex="-1"></a>      <span class="at">convergence =</span> <span class="fu">max</span>(fit<span class="sc">$</span><span class="fu">summary</span>()<span class="sc">$</span>rhat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&lt;</span> <span class="fl">1.01</span>,</span>
<span id="cb15-56"><a href="#cb15-56" tabindex="-1"></a>      <span class="at">loglik =</span> <span class="cn">NA</span></span>
<span id="cb15-57"><a href="#cb15-57" tabindex="-1"></a>    )</span>
<span id="cb15-58"><a href="#cb15-58" tabindex="-1"></a>  },</span>
<span id="cb15-59"><a href="#cb15-59" tabindex="-1"></a>  <span class="at">pattern =</span> <span class="fu">map</span>(simulated_data)</span>
<span id="cb15-60"><a href="#cb15-60" tabindex="-1"></a>)</span>
<span id="cb15-61"><a href="#cb15-61" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/fit_naive.R.</span></span></code></pre></div>
<h2 id="fit-ward-et-al-latent-variable-models">Fit Ward et al. latent
variable models</h2>
<p>Current best practice method for comparison.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  ward_fits,</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  {</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>    <span class="co"># Placeholder for Ward et al. Stan model</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>    <span class="co"># Would implement latent variable approach</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>    </span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>      <span class="at">scenario_id =</span> simulated_data<span class="sc">$</span>scenario_id[<span class="dv">1</span>],</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">&quot;ward&quot;</span>,</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>      <span class="at">param1_est =</span> <span class="fl">5.1</span>,</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>      <span class="at">param1_se =</span> <span class="fl">0.2</span>,</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>      <span class="at">param2_est =</span> <span class="fl">1.1</span>,</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>      <span class="at">param2_se =</span> <span class="fl">0.1</span>,</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>      <span class="at">convergence =</span> <span class="dv">0</span>,</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>      <span class="at">loglik =</span> <span class="sc">-</span><span class="dv">1000</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>    )</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>  },</span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a>  <span class="at">pattern =</span> <span class="fu">map</span>(simulated_data)</span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>)</span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/fit_ward.R.</span></span></code></pre></div>
<h2 id="combine-all-model-fits">Combine all model fits</h2>
<p>Aggregate results from all methods for comparison.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  all_model_fits,</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  {</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>      primarycensored_fits,</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>      naive_fits,</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>      ward_fits</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>    )</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>  }</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>)</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/combine_model_fits.R.</span></span></code></pre></div>
<h1 id="model-evaluation">Model Evaluation</h1>
<h2 id="calculate-parameter-recovery-metrics">Calculate parameter
recovery metrics</h2>
<p>Assess bias and accuracy of parameter estimates (Methods lines
280-286).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  parameter_recovery,</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  {</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>    <span class="co"># Calculate bias, coverage, RMSE for each method and scenario</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>    <span class="co"># Real implementation would compare estimated vs true parameters</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>    </span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>    all_model_fits <span class="sc">|&gt;</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">group_by</span>(method, scenario_id) <span class="sc">|&gt;</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>        <span class="at">bias_param1 =</span> <span class="fu">mean</span>(estimate[parameter <span class="sc">==</span> <span class="st">&quot;param1&quot;</span>] <span class="sc">-</span> <span class="dv">5</span>),</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>        <span class="at">bias_param2 =</span> <span class="fu">mean</span>(estimate[parameter <span class="sc">==</span> <span class="st">&quot;param2&quot;</span>] <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>        <span class="at">coverage_param1 =</span> <span class="fl">0.95</span>,  <span class="co"># Placeholder</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>        <span class="at">coverage_param2 =</span> <span class="fl">0.94</span>,  <span class="co"># Placeholder</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>        <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>      )</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>  }</span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>)</span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/parameter_recovery.R.</span></span></code></pre></div>
<h2 id="extract-convergence-diagnostics">Extract convergence
diagnostics</h2>
<p>Compile MCMC diagnostics for Bayesian models (Results line 318).</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  convergence_diagnostics,</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  {</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>    <span class="co"># Placeholder for convergence diagnostics</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>    <span class="co"># Real implementation would extract R-hat, divergences, ESS from Bayesian fits</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>    </span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>    <span class="co"># Create placeholder data</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>      <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;primarycensored&quot;</span>, <span class="st">&quot;ward&quot;</span>),</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>      <span class="at">mean_rhat =</span> <span class="fu">c</span>(<span class="fl">1.001</span>, <span class="fl">1.005</span>),</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>      <span class="at">total_divergences =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">54</span>),</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>      <span class="at">mean_ess =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">800</span>),</span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>      <span class="at">mean_runtime =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">150</span>)</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>    )</span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a>  }</span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a>)</span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/convergence_diagnostics.R.</span></span></code></pre></div>
<h1 id="case-study-ebola-epidemic">Case Study: Ebola Epidemic</h1>
<h2 id="prepare-ebola-data-for-analysis">Prepare Ebola data for
analysis</h2>
<p>Split data by observation windows for real-time and retrospective
analyses.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  ebola_analysis_data,</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  {</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>    <span class="co"># Prepare data for each observation window</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>    <span class="co"># Real implementation would handle date calculations properly</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>    </span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>    observation_windows <span class="sc">|&gt;</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">rowwise</span>() <span class="sc">|&gt;</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>        <span class="at">data =</span> <span class="fu">list</span>(</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>          ebola_data <span class="sc">|&gt;</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>              symptom_onset_date <span class="sc">&gt;=</span> <span class="fu">min</span>(ebola_data<span class="sc">$</span>symptom_onset_date) <span class="sc">+</span> start_day,</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>              symptom_onset_date <span class="sc">&lt;</span> <span class="fu">min</span>(ebola_data<span class="sc">$</span>symptom_onset_date) <span class="sc">+</span> end_day</span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>            )</span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>        )</span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a>      ) <span class="sc">|&gt;</span></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>  }</span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>)</span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/ebola_analysis_data.R.</span></span></code></pre></div>
<h2 id="fit-models-to-ebola-data">Fit models to Ebola data</h2>
<p>Apply all three methods to each observation window.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>  ebola_model_fits,</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  {</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>    <span class="co"># Fit models for both real-time and retrospective analyses</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>    <span class="co"># Assume gamma distribution as per manuscript</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>    </span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>      <span class="at">window_id =</span> ebola_analysis_data<span class="sc">$</span>window_id,</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>      <span class="at">analysis_type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;real-time&quot;</span>, <span class="st">&quot;retrospective&quot;</span>), <span class="at">each =</span> <span class="fu">nrow</span>(ebola_analysis_data)),</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>      <span class="at">primarycensored =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fl">2.5</span>, <span class="at">scale =</span> <span class="fl">3.2</span>),</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>      <span class="at">naive =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fl">2.1</span>, <span class="at">scale =</span> <span class="fl">2.8</span>),</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>      <span class="at">ward =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="fl">2.6</span>, <span class="at">scale =</span> <span class="fl">3.3</span>),</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>      <span class="at">runtime_pc =</span> <span class="dv">5</span>,</span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>      <span class="at">runtime_ward =</span> <span class="dv">150</span>,</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>      <span class="at">ess_per_second_pc =</span> <span class="dv">200</span>,</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>      <span class="at">ess_per_second_ward =</span> <span class="dv">10</span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>    )</span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>  }</span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a>)</span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/ebola_model_fits.R.</span></span></code></pre></div>
<h1 id="visualization">Visualization</h1>
<h2 id="figure-1-numerical-validation">Figure 1: Numerical
Validation</h2>
<p>Create the three-panel figure showing PMF comparison, accuracy
metrics, and computational efficiency.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  figure1_numerical,</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>  {</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>    <span class="co"># Panel A: PMF comparison</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>    panel_a <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;A. PMF Comparison&quot;</span>)</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>    </span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>    <span class="co"># Panel B: Accuracy metrics  </span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>    panel_b <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;B. Total Variation Distance&quot;</span>)</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>    </span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a>    <span class="co"># Panel C: Runtime comparison</span></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a>    panel_c <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;C. Computational Efficiency&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">scale_y_log10</span>()</span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a>    </span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a>    <span class="co"># Combine panels</span></span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a>    patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(panel_a, panel_b, panel_c, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a>  }</span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a>)</span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/figure1_numerical.R.</span></span></code></pre></div>
<h2 id="figure-2-parameter-recovery">Figure 2: Parameter Recovery</h2>
<p>Show parameter recovery across distributions and scenarios.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  figure2_parameters,</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  {</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>    <span class="co"># Panel A: Gamma distribution posteriors</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>    panel_a <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;A. Gamma Parameter Recovery&quot;</span>)</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>    </span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>    <span class="co"># Panel B: Bias comparison across distributions</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>    panel_b <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;B. Relative Bias (%)&quot;</span>)</span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>    </span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>    <span class="co"># Panel C: Effect of censoring width</span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a>    panel_c <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;C. Censoring Width Effect&quot;</span>)</span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a>    </span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a>    patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(panel_a, panel_b, panel_c, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a>  }</span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a>)</span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/figure2_parameters.R.</span></span></code></pre></div>
<h2 id="figure-3-ebola-case-study">Figure 3: Ebola Case Study</h2>
<p>Visualize results from the Sierra Leone Ebola analysis.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>  figure3_ebola,</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>  {</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>    <span class="co"># Panel A: Parameter estimates over time</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>    panel_a <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;A. Parameter Estimates&quot;</span>)</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>    </span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>    <span class="co"># Panel B: Mean delay over observation windows</span></span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>    panel_b <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;B. Mean Delay Estimates&quot;</span>)</span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a>    </span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a>    <span class="co"># Panel C: Computational performance</span></span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a>    panel_c <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;C. Effective Samples per Second&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">scale_y_log10</span>()</span>
<span id="cb24-19"><a href="#cb24-19" tabindex="-1"></a>    </span>
<span id="cb24-20"><a href="#cb24-20" tabindex="-1"></a>    patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(panel_a, panel_b, panel_c, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb24-21"><a href="#cb24-21" tabindex="-1"></a>  }</span>
<span id="cb24-22"><a href="#cb24-22" tabindex="-1"></a>)</span>
<span id="cb24-23"><a href="#cb24-23" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/figure3_ebola.R.</span></span></code></pre></div>
<h2 id="save-all-figures">Save all figures</h2>
<p>Export figures in publication-ready format.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>  saved_figures,</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>  {</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>    <span class="co"># Main figures</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>    <span class="fu">.save_plot</span>(figure1_numerical, <span class="st">&quot;figure1_numerical_validation.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>    <span class="fu">.save_plot</span>(figure2_parameters, <span class="st">&quot;figure2_parameter_recovery.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>    <span class="fu">.save_plot</span>(figure3_ebola, <span class="st">&quot;figure3_ebola_case_study.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>    </span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>    <span class="co"># Supplementary figures would be added here</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>    </span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>    <span class="cn">TRUE</span></span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>  }</span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a>)</span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/save_all_figures.R.</span></span></code></pre></div>
<h1 id="results-summary">Results Summary</h1>
<h2 id="generate-supplementary-results">Generate supplementary
results</h2>
<p>Additional analyses for supporting information.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>  supplementary_results,</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>  {</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>    <span class="co"># S1: Detailed convergence diagnostics</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>    <span class="co"># S2: Full parameter estimates by scenario</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>    <span class="co"># S3: Sensitivity analyses</span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>    </span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>      <span class="at">convergence =</span> convergence_diagnostics,</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>      <span class="at">full_estimates =</span> all_model_fits,</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>      <span class="at">message =</span> <span class="st">&quot;Additional supplementary analyses would go here&quot;</span></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a>    )</span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a>  }</span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a>)</span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/supplementary_results.R.</span></span></code></pre></div>
<h2 id="save-all-results">Save all results</h2>
<p>Export results in various formats for manuscript and
reproducibility.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>  saved_results,</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>  {</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>    <span class="co"># Save detailed results for reproducibility</span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>    <span class="fu">.save_data</span>(scenario_grid, <span class="st">&quot;scenario_definitions.csv&quot;</span>, <span class="at">path =</span> <span class="st">&quot;results&quot;</span>)</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>    <span class="fu">.save_data</span>(all_model_fits, <span class="st">&quot;all_model_fits.csv&quot;</span>, <span class="at">path =</span> <span class="st">&quot;results&quot;</span>)</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>    <span class="fu">.save_data</span>(parameter_recovery, <span class="st">&quot;parameter_recovery.csv&quot;</span>, <span class="at">path =</span> <span class="st">&quot;results&quot;</span>)</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>    <span class="fu">.save_data</span>(pmf_comparison, <span class="st">&quot;pmf_comparison.csv&quot;</span>, <span class="at">path =</span> <span class="st">&quot;results&quot;</span>)</span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>    <span class="fu">.save_data</span>(runtime_comparison, <span class="st">&quot;runtime_comparison.csv&quot;</span>, <span class="at">path =</span> <span class="st">&quot;results&quot;</span>)</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>    <span class="fu">.save_data</span>(ebola_model_fits, <span class="st">&quot;ebola_results.csv&quot;</span>, <span class="at">path =</span> <span class="st">&quot;results&quot;</span>)</span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>    </span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a>    <span class="cn">TRUE</span></span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>  }</span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a>)</span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/save_all_results.R.</span></span></code></pre></div>
<h1 id="report">Report</h1>
<h2 id="generate-analysis-summary">Generate analysis summary</h2>
<p>Provide overview of completed analyses and key findings.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>  analysis_summary,</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>  {</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>    <span class="co"># Count completed analyses</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>    n_scenarios <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scenario_grid)</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>    n_methods <span class="ot">&lt;-</span> <span class="dv">3</span>  <span class="co"># primarycensored, naive, ward</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>    n_distributions <span class="ot">&lt;-</span> <span class="fu">nrow</span>(distributions)</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>    </span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>    <span class="co"># Summary message</span></span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== ANALYSIS COMPLETE ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;✓ Simulated data for %d scenarios</span><span class="sc">\n</span><span class="st">&quot;</span>, n_scenarios))</span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;✓ Tested %d distributions with %d methods</span><span class="sc">\n</span><span class="st">&quot;</span>, n_distributions, n_methods))</span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;✓ Validated numerical accuracy against Monte Carlo</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;✓ Assessed parameter recovery under censoring/truncation</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;✓ Applied methods to Ebola case study</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;✓ Generated %d main figures</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="dv">3</span>))</span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Results saved to data/results/</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Figures saved to figures/</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;========================</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb28-20"><a href="#cb28-20" tabindex="-1"></a>    </span>
<span id="cb28-21"><a href="#cb28-21" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb28-22"><a href="#cb28-22" tabindex="-1"></a>      <span class="at">completed =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-23"><a href="#cb28-23" tabindex="-1"></a>      <span class="at">timestamp =</span> <span class="fu">Sys.time</span>()</span>
<span id="cb28-24"><a href="#cb28-24" tabindex="-1"></a>    )</span>
<span id="cb28-25"><a href="#cb28-25" tabindex="-1"></a>  }</span>
<span id="cb28-26"><a href="#cb28-26" tabindex="-1"></a>)</span>
<span id="cb28-27"><a href="#cb28-27" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/analysis_summary.R.</span></span></code></pre></div>

</body>
</html>
